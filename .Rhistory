# gdp_data
gdp_data |>
group_by(Country) |>
summarise(max_gdp_pc = max(GDP_per_capita)) |>
slice_max(max_gdp_pc, n = 5) |>
arrange(desc(Year))
max_gdp <- gdp_data |>
group_by(Country) |>
summarise(max_gdp_pc = max(GDP_per_capita)) |>
arrange(desc(max_gdp_pc))
# max_gdp
library(fpp3)
# alculate GDP per capita while maintaining tsibble structure
gdp_data <- global_economy |>
mutate(GDP_per_capita = GDP / Population) |>
# Drop rows with missing values to keep the analysis clean
filter(!is.na(GDP_per_capita))
# Find the year with the maximum GDP per capita for each country
# When using slice_max on a tsibble, it respects the Key (Country)
max_gdp <- gdp_data |>
group_by(Country) |>
slice_max(GDP_per_capita, n = 1, with_ties = FALSE) |>
ungroup() |>
# Select relevant columns
select(Country, Year, GDP_per_capita, Population) |>
# Arrange by the highest values globally
arrange(desc(GDP_per_capita))
# View the result (this will return a tsibble)
print(max_gdp)
library(ggplot2)
library(dplyr)
library(scales)
# Top 20 countries by max GDP per capita
top20_gdp <- max_gdp |>
slice_max(GDP_per_capita, n = 20)
# Reduce bar length by dividing GDP per capita by 1000 (show in thousands)
ggplot(top20_gdp, aes(x = reorder(Country, GDP_per_capita), y = GDP_per_capita/1000, fill = GDP_per_capita)) +
geom_col(width = 0.7) +  # slightly thinner bars
geom_text(aes(label = scales::comma(Population)), hjust = -0.1, size = 3) +
coord_flip(clip = "off") +
scale_fill_gradient(low = "lightblue", high = "darkblue") +
labs(
title = "Top 20 Countries by Maximum GDP per Capita",
subtitle = "GDP per capita shown in thousands; population next to bars",
x = "Country",
y = "Maximum GDP per Capita (Thousands)",
fill = "GDP per Capita"
) +
theme_minimal() +
theme(
plot.margin = margin(10, 50, 10, 10)
)
monaco_top_years <- top_country_each_year |>
filter(Country == "Monaco") |>
arrange(desc(GDP_per_capita))
# monaco_top_years
# Separate Monaco
monaco_data <- gdp_data |>
filter(Country == "Monaco")
# Plot all countries faint + Monaco highlighted
ggplot(gdp_data, aes(x = Year, y = GDP_per_capita, group = Country)) +
geom_line(color = "gray", alpha = 0.3) +  # all countries faint
geom_line(data = monaco_data, aes(x = Year, y = GDP_per_capita, color = "Monaco"), size = 1.5) +
geom_point(data = top_country_each_year, aes(x = Year, y = GDP_per_capita, color = Country), size = 2) + # top country each year
scale_color_manual(values = c("Monaco" = "red")) +
labs(
title = "GDP per Capita Over Time (Monaco Highlighted)",
subtitle = "Red line shows Monaco; points show top country each year",
x = "Year",
y = "GDP per Capita",
color = ""
) +
theme_minimal()
library(fpp3)
# Calculate GDP per capita and the % Change Rate
gdp_with_growth <- global_economy |>
mutate(GDP_per_capita = GDP / Population) |>
group_by(Country) |>
# difference() calculates (Year_t - Year_t-1)
# We divide by the previous year and multiply by 100 for percentage
mutate(pct_change = (difference(GDP_per_capita) / lag(GDP_per_capita)) * 100) |>
ungroup()
# Find the top 5 countries by max GDP per capita and show their growth rate
top5_max_gdp <- gdp_with_growth |>
group_by(Country) |>
slice_max(GDP_per_capita, n = 1, with_ties = FALSE) |>
ungroup() |>
slice_max(GDP_per_capita, n = 10) |>
# Select relevant columns including the new growth rate
select(Country, Year, Population, GDP_per_capita, pct_change) |>
arrange(desc(Year))
# View the result
print(top5_max_gdp)
# Load libraries and filter data
library(fpp3)
library(dplyr)
library(ggplot2)
# Filter for United States
us_gdp <- global_economy |>
filter(Country == "United States") |>
select(Year, GDP)
#us_gdp
ggplot(us_gdp, aes(x = Year, y = GDP)) +
geom_line(color = "steelblue", size = 1) +
labs(
title = "United States GDP Over Time",
x = "Year",
y = "GDP (US Dollars)"
) +
theme_minimal()
# Remove heterogeneity so you fit more simple model
library(fpp3)
us_gdp |>
autoplot(log(GDP), colour = "darkred" , size = 1.2) +
labs(
y = "Log GDP",
title = "United States GDP Over Time (Log Scale)"
) +
theme_minimal()
library(fpp3)
library(ggplot2)
library(dplyr)
# US GDP data
us_gdp <- global_economy |>
filter(Country == "United States") |>
select(Year, GDP)
# Define some major recession years
recessions <- data.frame(
Year = c(1929, 1933, 1974, 1982, 2008),
Label = c("Great Depression", "End Depression", "1973 Oil Crisis", "Early 80s Recession", "2008 Financial Crisis")
)
# Plot log GDP with thick line, highlight recessions
us_gdp |>
autoplot(log(GDP), colour = "darkgreen", size = 1.2) +
geom_point(data = recessions, aes(x = Year, y = log(us_gdp$GDP[match(Year, us_gdp$Year)])),
colour = "red", size = 3) +
geom_text(data = recessions, aes(x = Year, y = log(us_gdp$GDP[match(Year, us_gdp$Year)]), label = Label),
vjust = -1, hjust = 0.5, size = 3.5, colour = "red") +
labs(
y = "Log GDP",
title = "United States GDP Over Time (Log Scale) with Major Recessions Highlighted"
) +
theme_minimal()
library(fpp3)
library(dplyr)
library(ggplot2)
# view(aus_livestock)
library(fpp3)
library(dplyr)
# Filter for Victoria and the "Bulls, bullocks and steers" series
vic_bulls <- aus_livestock |>
filter(State == "Victoria",
Animal == "Bulls, bullocks and steers") |>
mutate(Slaughter_Count = Count) |>
select(Month, Slaughter_Count)
# vic_bulls
vic_bulls |>
autoplot(Slaughter_Count, colour = "steelblue", size = 0.7) +
labs(
title = "Slaughter of Bulls, Bullocks and Steers in Victoria",
y = "Number Slaughtered",
x = "Year"
) +
theme_minimal()
# Calculate optimal lambda
optimal_lambda <- vic_bulls |>
features(Slaughter_Count, features = guerrero) |>
pull(lambda_guerrero)
optimal_lambda
# Apply transformation
vic_bulls |>
autoplot(box_cox(Slaughter_Count, optimal_lambda)) +
labs(title = "Transformed Victoria Bulls Slaughter",
subtitle = paste("Box-Cox transformation with lambda =", round(optimal_lambda, 3)),
y = "Transformed Units")
# Apply the specific lambda calculated via Guerrero
final_lambda <- -0.04461887
vic_bulls |>
autoplot(box_cox(Slaughter_Count, final_lambda)) +
labs(
title = "Transformed Victoria Bulls Slaughter Count",
subtitle = paste("Box-Cox transformation applied with lambda =", round(final_lambda, 4)),
y = "Transformed Units"
) +
theme_minimal()
library(fpp3)
library(dplyr)
# Inspect the vic_elec dataset
# head(vic_elec)
vic_elec_daily <- vic_elec |>
index_by(Date = date(Time)) |>
summarise(Daily_Demand = sum(Demand, na.rm = TRUE))
# vic_elec_daily
vic_elec_daily |>
autoplot(Daily_Demand, colour = "orange", size = 1.0) +
labs(
title = "Daily Electricity Demand in Victoria",
y = "Daily Demand (MW)",
x = "Date"
) +
theme_minimal()
library(fpp3)
# Calculate the optimal lambda for Daily_Demand
daily_lambda <- vic_elec_daily |>
features(Daily_Demand, features = guerrero) |>
pull(lambda_guerrero)
# Display the result
daily_lambda
library(fpp3)
# Applying the specific lambda value discovered
lambda_val <- -0.8999268
vic_elec_daily |>
autoplot(box_cox(Daily_Demand, lambda_val)) +
labs(
title = "Transformed Daily Electricity Demand",
subtitle = paste("Applied Box-Cox transformation with lambda =", round(lambda_val, 4)),
y = "Transformed Units"
) +
theme_minimal()
library(fpp3)
library(dplyr)
head(aus_production)
gas_production <- aus_production |>
select(Quarter, Gas)
gas_production
gas_production |>
autoplot(Gas, colour = "blue", size = 1.0) +
labs(
title = "Australian Gas Production",
y = "Gas Production",
x = "Quarter"
) +
theme_minimal()
# Calculate optimal lambda for Gas
gas_lambda <- gas_production |>
features(Gas, features = guerrero) |>
pull(lambda_guerrero)
# Plot the transformed series
gas_production |>
autoplot(box_cox(Gas, gas_lambda)) +
labs(title = "Transformed Australian Gas Production",
subtitle = paste("Box-Cox transformation with lambda =", round(gas_lambda, 3)),
y = "Transformed Units")
# canadian_gas
library(fpp3)
canadian_gas |>
autoplot(Volume, colour = "steelblue", size = 1.0) +
labs(
title = "Canadian Gas Production",
y = "Gas Volume",
x = "Month"
) +
theme_minimal()
library(fpp3)
library(dplyr)
library(latex2exp)
# Step 1: Calculate optimal Box-Cox lambda for Gas
lambda_gas <- canadian_gas |>
features(Volume, features = guerrero) |>
pull(lambda_guerrero)
# Step 2: Apply Box-Cox transformation and plot
canadian_gas |>
autoplot(box_cox(Volume, lambda_gas)) +
labs(
y = "Transformed Gas Production",
title = latex2exp::TeX(paste0(
"Box-Cox Transformed Gas Production with $\\lambda$ = ",
round(lambda_gas, 2)
))
) +
theme_minimal()
set.seed(12345678)
myseries <- aus_retail |>
filter(`Series ID` == sample(aus_retail$`Series ID`,1))
# myseries
library(fpp3)
myseries |>
autoplot(Turnover, colour = "steelblue", size = 1.0) +
labs(
title = "Retail Turnover",
y = "Turnover",
x = "Month"
) +
theme_minimal()
lambda_retail <- myseries |>
features(Turnover, features = guerrero) |>
pull(lambda_guerrero)
lambda_retail
myseries |>
autoplot(box_cox(Turnover, lambda_retail),
colour = "darkgreen", size = 1.0) +
labs(
title = paste("Box-Cox Transformed Retail Turnover (λ =",
round(lambda_retail,2), ")"),
y = "Transformed Turnover",
x = "Month"
) +
theme_minimal()
library(fpp3)
library(dplyr)
# head(aus_production)
library(fpp3)
aus_production |>
autoplot(Tobacco) +
labs(
title = "Australian Tobacco Production",
y = "Tobacco Production"
) +
theme_minimal()
lambda_tobacco <- aus_production |>
features(Tobacco, features = guerrero) |>
pull(lambda_guerrero)
lambda_tobacco
aus_production |>
autoplot(box_cox(Tobacco, lambda_retail),
colour = "darkgreen", size = 1.0) +
labs(
title = paste("Box-Cox Transformed AUS Production Tobacco (λ =",
round(lambda_retail,2), ")"),
y = "Transformed Tobacco",
x = "Month"
) +
theme_minimal()
library(fpp3)
# Filter the series for Economy class passengers on the MEL‑SYD route
economy <- ansett |>
filter(Airports == "MEL-SYD", Class == "Economy")
# economy
autoplot(economy, Passengers) +
labs(title = "Original Economy Class Passengers (MEL‑SYD)",
y = "Passengers", x = "Time")
lambda_economy <- economy |>
features(Passengers, features = guerrero) |>
pull(lambda_guerrero)
lambda_economy
lambda <- 1.999927
economy$Passengers_BoxCox <- if(lambda == 0){
log(econ$Passengers)
} else {
(economy$Passengers^lambda - 1)/lambda
}
# Plot original vs transformed
plot(economy$Passengers, type="o", col="blue", ylim=range(c(economy$Passengers, economy$Passengers_BoxCox)),
xlab="Time", ylab="Passengers", main="Original vs Box-Cox (λ ≈ 2)")
lines(economy$Passengers_BoxCox, type="o", col="red")
legend("topleft", legend=c("Original","Box-Cox λ≈2"), col=c("blue","red"), lty=1, pch=1)
economy |>
autoplot(box_cox(Passengers, lambda))
library(fpp3)
# Filter for Southern Cross Station
southern_cross <- pedestrian |>
filter(Sensor == "Southern Cross Station")
# southern_cross
southern_cross |>
autoplot(Count) +
labs(title = "Pedestrian Counts: Southern Cross Station",
y = "Number of Pedestrians")
# Calculate the optimal lambda
lambda <- southern_cross %>%
features(Count, features = guerrero) %>%
pull(lambda_guerrero)
# Display the value
lambda
# Apply the specific lambda found
southern_cross |>
autoplot(box_cox(Count, lambda)) +
labs(
title = "Box-Cox Transformed: Southern Cross Station",
subtitle = "Lambda = -0.25",
y = "Transformed Count"
)
# Load the necessary library
library(fpp3)
# Extract the last 5 years (20 quarters) of Gas data
gas <- tail(aus_production, 5 * 4) |>
select(Gas)
# Plot the time series
gas |>
autoplot(Gas) +
labs(title = "Australian Gas Production: Last 5 Years",
y = "Petajoules",
x = "Quarter")
# Perform classical multiplicative decomposition
gas_decomp <- gas |>
model(
classical = classical_decomposition(Gas, type = "multiplicative")
) |>
components()
# Plot the decomposed components
gas_decomp |>
autoplot() +
labs(title = "Classical Multiplicative Decomposition of Gas Production")
library(fpp3)
# 1. Prepare the data (last 5 years)
gas <- tail(aus_production, 5 * 4) |> select(Gas)
# 2. Perform the decomposition and extract components
gas_decomp <- gas |>
model(classical = classical_decomposition(Gas, type = "multiplicative")) |>
components()
# 3. Plot the Seasonally Adjusted data
gas_decomp |>
autoplot(season_adjust) +
labs(title = "Seasonally Adjusted Gas Production (Last 5 Years)",
subtitle = "Multiplicative Seasonality Removed",
y = "Petajoules")
library(fpp3)
# 1. Prepare the original 5-year data
gas <- tail(aus_production, 5 * 4) |> select(Gas)
# 2. Create a version with an outlier (adding 300 to the 10th observation)
gas_outlier <- gas
gas_outlier$Gas[10] <- gas_outlier$Gas[10] + 300
# 3. Recompute the multiplicative decomposition
decomp_outlier <- gas_outlier |>
model(classical = classical_decomposition(Gas, type = "multiplicative")) %>%
components()
# 4. Plot the new seasonally adjusted data
decomp_outlier |>
autoplot(season_adjust) +
labs(title = "Seasonally Adjusted Data with an Outlier",
subtitle = "300 units added to the 10th observation",
y = "Petajoules")
library(fpp3)
# 1. Get the base data
gas_base <- tail(aus_production, 5 * 4) |> select(Gas)
# 2. Case A: Outlier in the middle (10th point)
gas_mid <- gas_base
gas_mid$Gas[10] <- gas_mid$Gas[10] + 300
# 3. Case B: Outlier at the end (20th point)
gas_end <- gas_base
gas_end$Gas[20] <- gas_end$Gas[20] + 300
# 4. Decompose both
decomp_mid <- gas_mid |> model(classical_decomposition(Gas, type="multiplicative")) |> components()
decomp_end <- gas_end |> model(classical_decomposition(Gas, type="multiplicative")) |> components()
# 5. Check the Seasonal Indices
# Middle outlier changes the indices for every year
unique(decomp_mid$seasonal)
# End outlier leaves indices identical to the original data
unique(decomp_end$seasonal)
set.seed(12345678)
myseries <- aus_retail |>
filter(`Series ID` == sample(aus_retail$`Series ID`,1))
myseries
# Load the necessary libraries
library(fpp3)
library(seasonal)
# Perform the X-11 decomposition
x11_dcmp <- myseries |>
model(x11 = X_13ARIMA_SEATS(Turnover ~ x11())) |>
components()
# Generate the decomposition plot
autoplot(x11_dcmp) +
labs(title = "X-11 Decomposition of Australian Retail Turnover")
monaco_top_years <- top_country_each_year |>
dplyr::filter(Country == "Monaco") |>
dplyr::arrange(desc(GDP_per_capita))
# monaco_top_years
library(dplyr)
monaco_top_years <- top_country_each_year |>
dplyr::filter(Country == "Monaco") |>
dplyr::arrange(desc(GDP_per_capita))
# monaco_top_years
library(dplyr)
monaco_top_years <- top_country_each_year |>
dplyr::filter(Country == "Monaco") |>
dplyr::arrange(desc(GDP_per_capita))
monaco_top_years
library(dplyr)
monaco_top_years <- top20_gdp |>
dplyr::filter(Country == "Monaco") |>
dplyr::arrange(desc(GDP_per_capita))
monaco_top_years
library(dplyr)
monaco_top_years <- top20_gdp |>
filter(Country == "Monaco") |>
arrange(desc(GDP_per_capita))
monaco_top_years
# Separate Monaco
monaco_data <- gdp_data |>
filter(Country == "Monaco")
# Plot all countries faint + Monaco highlighted
ggplot(gdp_data, aes(x = Year, y = GDP_per_capita, group = Country)) +
geom_line(color = "gray", alpha = 0.3) +  # all countries faint
geom_line(data = monaco_data, aes(x = Year, y = GDP_per_capita, color = "Monaco"), size = 1.5) +
geom_point(data = top20_gdp, aes(x = Year, y = GDP_per_capita, color = Country), size = 2) + # top country each year
scale_color_manual(values = c("Monaco" = "red")) +
labs(
title = "GDP per Capita Over Time (Monaco Highlighted)",
subtitle = "Red line shows Monaco; points show top country each year",
x = "Year",
y = "GDP per Capita",
color = ""
) +
theme_minimal()
# Separate Monaco
monaco_data <- gdp_data |>
filter(Country == "Monaco")
# Plot all countries faint + Monaco highlighted
ggplot(gdp_data, aes(x = Year, y = GDP_per_capita, group = Country)) +
geom_line(color = "gray", alpha = 0.3) +  # all countries faint
geom_line(data = monaco_data, aes(x = Year, y = GDP_per_capita, color = "Monaco"), size = 1.0) +
geom_point(data = top20_gdp, aes(x = Year, y = GDP_per_capita, color = Country), size = 2) + # top country each year
scale_color_manual(values = c("Monaco" = "red")) +
labs(
title = "GDP per Capita Over Time (Monaco Highlighted)",
subtitle = "Red line shows Monaco; points show top country each year",
x = "Year",
y = "GDP per Capita",
color = ""
) +
theme_minimal()
knitr::opts_chunk$set(echo = TRUE, fig.retina = NULL)
tinytex::reinstall_tinytex(repository = "illinois")
